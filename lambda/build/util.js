"use strict";
const AWS = require('aws-sdk');
const s3SigV4Client = new AWS.S3({
    signatureVersion: 'v4',
    region: process.env.S3_PERSISTENCE_REGION
});
module.exports.getS3PreSignedUrl = function getS3PreSignedUrl(s3ObjectKey) {
    const bucketName = process.env.S3_PERSISTENCE_BUCKET;
    const s3PreSignedUrl = s3SigV4Client.getSignedUrl('getObject', {
        Bucket: bucketName,
        Key: s3ObjectKey,
        Expires: 60 * 1 // the Expires is capped for 1 minute
    });
    console.log(`Util.s3PreSignedUrl: ${s3ObjectKey} URL ${s3PreSignedUrl}`);
    return s3PreSignedUrl;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy91dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxNQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFFL0IsTUFBTSxhQUFhLEdBQUcsSUFBSSxHQUFHLENBQUMsRUFBRSxDQUFDO0lBQzdCLGdCQUFnQixFQUFFLElBQUk7SUFDdEIsTUFBTSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMscUJBQXFCO0NBQzVDLENBQUMsQ0FBQztBQUVILE1BQU0sQ0FBQyxPQUFPLENBQUMsaUJBQWlCLEdBQUcsU0FBUyxpQkFBaUIsQ0FBQyxXQUFnQjtJQUUxRSxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDO0lBQ3JELE1BQU0sY0FBYyxHQUFHLGFBQWEsQ0FBQyxZQUFZLENBQUMsV0FBVyxFQUFFO1FBQzNELE1BQU0sRUFBRSxVQUFVO1FBQ2xCLEdBQUcsRUFBRSxXQUFXO1FBQ2hCLE9BQU8sRUFBRSxFQUFFLEdBQUMsQ0FBQyxDQUFDLHFDQUFxQztLQUN0RCxDQUFDLENBQUM7SUFDSCxPQUFPLENBQUMsR0FBRyxDQUFDLHdCQUF3QixXQUFXLFFBQVEsY0FBYyxFQUFFLENBQUMsQ0FBQztJQUN6RSxPQUFPLGNBQWMsQ0FBQztBQUUxQixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBV1MgPSByZXF1aXJlKCdhd3Mtc2RrJyk7XG5cbmNvbnN0IHMzU2lnVjRDbGllbnQgPSBuZXcgQVdTLlMzKHtcbiAgICBzaWduYXR1cmVWZXJzaW9uOiAndjQnLFxuICAgIHJlZ2lvbjogcHJvY2Vzcy5lbnYuUzNfUEVSU0lTVEVOQ0VfUkVHSU9OXG59KTtcblxubW9kdWxlLmV4cG9ydHMuZ2V0UzNQcmVTaWduZWRVcmwgPSBmdW5jdGlvbiBnZXRTM1ByZVNpZ25lZFVybChzM09iamVjdEtleTogYW55KSB7XG5cbiAgICBjb25zdCBidWNrZXROYW1lID0gcHJvY2Vzcy5lbnYuUzNfUEVSU0lTVEVOQ0VfQlVDS0VUO1xuICAgIGNvbnN0IHMzUHJlU2lnbmVkVXJsID0gczNTaWdWNENsaWVudC5nZXRTaWduZWRVcmwoJ2dldE9iamVjdCcsIHtcbiAgICAgICAgQnVja2V0OiBidWNrZXROYW1lLFxuICAgICAgICBLZXk6IHMzT2JqZWN0S2V5LFxuICAgICAgICBFeHBpcmVzOiA2MCoxIC8vIHRoZSBFeHBpcmVzIGlzIGNhcHBlZCBmb3IgMSBtaW51dGVcbiAgICB9KTtcbiAgICBjb25zb2xlLmxvZyhgVXRpbC5zM1ByZVNpZ25lZFVybDogJHtzM09iamVjdEtleX0gVVJMICR7czNQcmVTaWduZWRVcmx9YCk7XG4gICAgcmV0dXJuIHMzUHJlU2lnbmVkVXJsO1xuXG59Il19